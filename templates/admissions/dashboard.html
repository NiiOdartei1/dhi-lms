{% extends "admissions/base_admission.html" %}

{% block title %}Applicant Dashboard{% endblock %}

{% block content %}
<div class="container my-4">

    <!-- Page Header -->
    <div class="mb-4">
        <h3 class="fw-bold">Applicant Dashboard</h3>
        <p class="text-muted">Online Admissions Portal</p>
    </div>

    <div class="row g-4">

        <!-- LEFT: MAIN PANEL -->
        <div class="col-lg-8">

            <!-- Application Status Section -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="fw-bold mb-3">Welcome, {{ applicant.email }}</h5>

                    {% if applicant.application %}
                        {% set status = applicant.application.status %}

                        {% if status == 'approved' %}
    <p class="mb-3 text-success fw-bold">
        ðŸŽ‰ Congratulations! Your application has been approved. 
        Please proceed to pay your school fees to secure your placement.
    </p>
    <a href="/student/login?next=/student/pay-fees" class="btn btn-success">
    Pay School Fees
</a>

    <a href="{{ url_for('admissions.preview') }}" class="btn btn-outline-secondary">View Submitted Application</a>
{% elif status in ['draft', 'submitted'] %}

                        {% elif status == 'rejected' %}
                            <p class="mb-3 text-danger fw-bold">Unfortunately, your application was not successful.</p>
                            <a href="{{ url_for('admissions.dashboard') }}" class="btn btn-outline-danger">Contact Admissions Office</a>

                        {% else %}
                            <p class="mb-3">Current application status: <strong>{{ status }}</strong></p>
                            <a href="{{ url_for('admissions.preview') }}" class="btn btn-outline-secondary">View</a>
                        {% endif %}

                    {% else %}
                        <p class="mb-3">You have not started an application yet.</p>
                        <a href="{{ url_for('admissions.start_application') }}" class="btn btn-success">Start New Application</a>
                    {% endif %}
                </div>
            </div>

            <!-- Important Notice -->
            <div class="card shadow-sm">
                <div class="card-header fw-bold bg-white">Important Notice</div>
                <div class="card-body">
                    <p class="text-muted mb-0">Please ensure that all information provided is accurate. Once submitted, applications cannot be edited.</p>
                </div>
            </div>

        </div>

        <!-- RIGHT: PROFILE PANEL -->
        <div class="col-lg-4">
            <div class="card shadow-sm">
                <div class="card-header fw-bold bg-white">Applicant Profile</div>
                <div class="card-body">
                    <p class="mb-2">
                        <strong>Email</strong><br>
                        {{ applicant.email }}
                    </p>
                    <p class="mb-2">
                        <strong>Phone</strong><br>
                        {{ applicant.phone or "Not provided" }}
                    </p>
                    <p class="mb-3">
                        <strong>Account Created</strong><br>
                        {{ applicant.created_at.strftime('%d %B %Y') if applicant.created_at else "â€”" }}
                    </p>
                    <hr>
                    <a href="{{ url_for('admissions.logout') }}" class="btn btn-outline-danger w-100">Logout</a>
                </div>
            </div>
        </div>

    </div>

</div>
{% endblock %}